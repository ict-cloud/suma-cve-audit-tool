use serde_derive::{Deserialize, Serialize};

#[derive(Debug, Clone, Serialize, Deserialize)]
pub struct Errata {
    pub id: i32, 
    pub date: String,
    pub update_date: String,
    pub advisory_synopsis: String,
    pub advisory_type: String,
    pub advisory_name: String,
}

#[derive(Debug, Clone, Serialize, Deserialize)]
pub struct CVE {
    pub cve_id: String,
    pub suse_errata_list: Vec<Errata> 
}

// Method implementation
impl CVE {

    pub fn add_errata(&mut self, e: &Errata) {
        self.suse_errata_list.push(e.to_owned());
    }
}